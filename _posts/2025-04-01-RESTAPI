---
title: "Flask REST API connecting"
excerpt: "Structure of Flask app, REST API, HTTP concept and application"

categories:
  - categories1
tags:
  - [tag1, tag2]

permalink: /categories1/Flask REST API connecting/

toc: true
toc_sticky: true

date: 2025-04-01
last_modified_at: 2025-04-01
---

### ë„¤íŠ¸ì›Œí¬ ê´€ì ì—ì„œ REST APIì˜ í•µì‹¬ ê°œë…

1. REST APIë€?
- Representational State Transferì˜ ì•½ì
- ì›¹ì˜ ê¸°ì¡´ ê¸°ìˆ ê³¼ HTTP í”„ë¡œí† ì½œì„ í™œìš©í•œ í†µì‹  ì•„í‚¤í…ì²˜
- í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ê°„ ë°ì´í„° êµí™˜ í‘œì¤€
1. HTTP ë©”ì„œë“œì™€ ì˜ë¯¸

```
GET    : ë°ì´í„° ì¡°íšŒ
POST   : ìƒˆë¡œìš´ ë°ì´í„° ìƒì„±
PUT    : ê¸°ì¡´ ë°ì´í„° ì „ì²´ ìˆ˜ì •
PATCH  : ê¸°ì¡´ ë°ì´í„° ì¼ë¶€ ìˆ˜ì •
DELETE : ë°ì´í„° ì‚­ì œ

```

1. HTTP ìƒíƒœ ì½”ë“œ

```
200 OK             : ìš”ì²­ ì„±ê³µ
201 Created        : ë¦¬ì†ŒìŠ¤ ìƒì„± ì„±ê³µ
400 Bad Request    : ì˜ëª»ëœ ìš”ì²­
401 Unauthorized   : ì¸ì¦ í•„ìš”
403 Forbidden      : ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ
404 Not Found      : ë¦¬ì†ŒìŠ¤ ì—†ìŒ
500 Internal Error : ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜

```

1. API í†µì‹  ê³¼ì •

```
í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ â†’ ì„œë²„ ì²˜ë¦¬ â†’ ì‘ë‹µ ë°˜í™˜
     â†“             â†“           â†“
  HTTP ë©”ì„œë“œ   ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§   JSON ë°ì´í„°

```

1. JSON ë°ì´í„° êµ¬ì¡°

```json
{
  "user": {
    "id": 1,
    "username": "example",
    "email": "user@example.com"
  }
}

```

1. API ë³´ì•ˆ í•µì‹¬ ìš”ì†Œ
- HTTPS ì‚¬ìš©
- ì¸ì¦ í† í° (JWT)
- ë°ì´í„° ê²€ì¦
- ìš”ì²­/ì‘ë‹µ ì•”í˜¸í™”
1. ë„¤íŠ¸ì›Œí¬ ê´€ì  API íë¦„

```
Client (ë¸Œë¼ìš°ì €/ì•±)
   â†“ HTTP ìš”ì²­
Web Server (Nginx/Apache)
   â†“ ìš”ì²­ ë¼ìš°íŒ…
WSGI Server (Gunicorn/uWSGI)
   â†“ ì• í”Œë¦¬ì¼€ì´ì…˜ ì²˜ë¦¬
Flask Application
   â†“ ë°ì´í„°ë² ì´ìŠ¤ ìƒí˜¸ì‘ìš©
Database
   â†“ ê²°ê³¼ ë°˜í™˜
Flask Application
   â†“ JSON ì‘ë‹µ ìƒì„±
WSGI Server
   â†“ ì‘ë‹µ ì „ì†¡
Web Server
   â†“ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µ
Client

```

1. API í…ŒìŠ¤íŠ¸ ë„êµ¬
- Postman
- cURL
- Swagger
1. ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ ê³„ì¸µ

```
ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ (HTTP/HTTPS)
   â†“
ì „ì†¡ ê³„ì¸µ (TCP/UDP)
   â†“
ì¸í„°ë„· ê³„ì¸µ (IP)
   â†“
ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ê³„ì¸µ

```

1. API ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­
- ìºì‹±
- ì••ì¶•
- ìµœì†Œí•œì˜ ë°ì´í„° ì „ì†¡
- ë¹„ë™ê¸° ì²˜ë¦¬

### ì¶”ê°€ë¡œ í•„ìš”í•œ í•™ìŠµ

- HTTP í”„ë¡œí† ì½œ ë™ì‘ ì›ë¦¬
- ë„¤íŠ¸ì›Œí¬ ì†Œì¼“ í†µì‹ 
- ì›¹ ë³´ì•ˆ
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜

---

### í”„ë¡œì íŠ¸ì— ì ìš©

<aside>
ğŸ’¡

í˜„ì¬ ìƒí™© : file ê¸°ë°˜ìœ¼ë¡œ ì—°ê²°ëœ Flask Application ì„ REST API ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì •í•¨

</aside>

1. í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°

```bash
your_project/
â”‚
â”œâ”€â”€ app.py             # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ íŒŒì¼
â”œâ”€â”€ models.py          # ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ ì •ì˜
â”œâ”€â”€ views.py           # API ë¼ìš°íŠ¸ ì •ì˜
â”œâ”€â”€ config.py          # ì„¤ì • íŒŒì¼
â”‚
â”œâ”€â”€ scripts/           # ìœ í‹¸ë¦¬í‹° ë° ë””ë²„ê¹… ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ check_users.py
â”‚   â”œâ”€â”€ create_db.py
â”‚   â””â”€â”€ debug_app.py
â”‚
â”œâ”€â”€ tests/             # í…ŒìŠ¤íŠ¸ ê´€ë ¨ íŒŒì¼ (ì„ íƒì‚¬í•­)
â”‚
â”œâ”€â”€ requirements.txt   # ì˜ì¡´ì„± íŒŒì¼
â””â”€â”€ README.md          # í”„ë¡œì íŠ¸ ì„¤ëª… íŒŒì¼
```

1. í˜„ì¬ ëª¨ë¸ 

```python
# models.py
from flask_sqlalchemy import SQLAlchemy
from werkzeug.security import generate_password_hash, check_password_hash

db = SQLAlchemy()

class User(db.Model):
    __tablename__ = 'users'

    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(20), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(255), nullable=False)

    def set_password(self, password):
        self.password = generate_password_hash(password)

    def check_password(self, password):
        return check_password_hash(self.password, password)

```

1. REST API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ([views.py](http://views.py/))

```python
from flask import Blueprint, jsonify, request
from models import db, User
from werkzeug.security import generate_password_hash

# API ë¸”ë£¨í”„ë¦°íŠ¸ ìƒì„±
api_routes = Blueprint('api', __name__, url_prefix='/api')

# ì‚¬ìš©ì ëª©ë¡ API
@api_routes.route('/users', methods=['GET'])
def get_users():
    users = User.query.all()
    user_list = []
    for user in users:
        user_data = {
            'id': user.id,
            'username': user.username,
            'email': user.email
        }
        user_list.append(user_data)
    return jsonify(user_list), 200

# ì‚¬ìš©ì ìƒì„± API
@api_routes.route('/users', methods=['POST'])
def create_user():
    data = request.get_json()

    # ë°ì´í„° ê²€ì¦
    if not data or not data.get('username') or not data.get('email') or not data.get('password'):
        return jsonify({'error': 'í•„ìˆ˜ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.'}), 400

    # ì¤‘ë³µ ì‚¬ìš©ì í™•ì¸
    existing_user = User.query.filter(
        (User.username == data['username']) |
        (User.email == data['email'])
    ).first()

    if existing_user:
        return jsonify({'error': 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤.'}), 400

    # ìƒˆ ì‚¬ìš©ì ìƒì„±
    new_user = User(
        username=data['username'],
        email=data['email']
    )
    new_user.set_password(data['password'])

    try:
        db.session.add(new_user)
        db.session.commit()

        return jsonify({
            'id': new_user.id,
            'username': new_user.username,
            'email': new_user.email
        }), 201
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'ì‚¬ìš©ì ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'details': str(e)}), 500

# íŠ¹ì • ì‚¬ìš©ì ì¡°íšŒ API
@api_routes.route('/users/<int:user_id>', methods=['GET'])
def get_user(user_id):
    user = User.query.get(user_id)

    if not user:
        return jsonify({'error': 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}), 404

    return jsonify({
        'id': user.id,
        'username': user.username,
        'email': user.email
    }), 200

# ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • API
@api_routes.route('/users/<int:user_id>', methods=['PUT'])
def update_user(user_id):
    user = User.query.get(user_id)

    if not user:
        return jsonify({'error': 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}), 404

    data = request.get_json()

    # ì„ íƒì  ì—…ë°ì´íŠ¸
    if 'username' in data:
        user.username = data['username']

    if 'email' in data:
        user.email = data['email']

    try:
        db.session.commit()
        return jsonify({
            'id': user.id,
            'username': user.username,
            'email': user.email
        }), 200
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'ì‚¬ìš©ì ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'details': str(e)}), 500

# ì‚¬ìš©ì ì‚­ì œ API
@api_routes.route('/users/<int:user_id>', methods=['DELETE'])
def delete_user(user_id):
    user = User.query.get(user_id)

    if not user:
        return jsonify({'error': 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}), 404

    try:
        db.session.delete(user)
        db.session.commit()
        return jsonify({'message': 'ì‚¬ìš©ì ì‚­ì œ ì„±ê³µ'}), 200
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'ì‚¬ìš©ì ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'details': str(e)}), 500

```

1. [app.py](http://app.py/) ìˆ˜ì •

```python
from flask import Flask
from config import Config
from models import db
from views import main_routes, api_routes  # API ë¼ìš°íŠ¸ ì¶”ê°€

def create_app():
    app = Flask(__name__)

    # config.pyì˜ ì„¤ì • ë¡œë“œ
    app.config.from_object(Config)

    # SQLAlchemy ì´ˆê¸°í™”
    db.init_app(app)

    # ë¸”ë£¨í”„ë¦°íŠ¸ ë“±ë¡
    app.register_blueprint(main_routes)
    app.register_blueprint(api_routes)  # API ë¸”ë£¨í”„ë¦°íŠ¸ ì¶”ê°€

    # ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±
    with app.app_context():
        db.create_all()

    return app

# ì•± ìƒì„±
app = create_app()

if __name__ == "__main__":
    app.run(debug=True)

```

- ì¶”ê°€ API í…ŒìŠ¤íŠ¸ ë°©ë²•:
1. Postman ì‚¬ìš©
2. cURL ëª…ë ¹ì–´

```bash
# ì‚¬ìš©ì ìƒì„±
curl -X POST <http://localhost:5000/api/users> \\
     -H "Content-Type: application/json" \\
     -d '{"username":"testuser", "email":"test@example.com", "password":"password123"}'

# ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
curl <http://localhost:5000/api/users>

# íŠ¹ì • ì‚¬ìš©ì ì¡°íšŒ
curl <http://localhost:5000/api/users/1>

# ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •
curl -X PUT <http://localhost:5000/api/users/1> \\
     -H "Content-Type: application/json" \\
     -d '{"username":"updateduser"}'

# ì‚¬ìš©ì ì‚­ì œ
curl -X DELETE <http://localhost:5000/api/users/1>

```

### ê¸°ì¡´ ì½”ë“œì™€ì˜ ì°¨ì´

ê¸°ì¡´ ì½”ë“œ (ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜):

```python
@main_routes.route("/register", methods=["GET", "POST"])
def register():
    # HTML í¼ì„ ì‚¬ìš©í•œ íšŒì›ê°€ì…
    form = RegistrationForm()
    if form.validate_on_submit():
        # ì‚¬ìš©ì ìƒì„± í›„ ì›¹ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
        user = User(username=form.username.data, email=form.email.data)
        user.set_password(form.password.data)

        try:
            db.session.add(user)
            db.session.commit()
            flash('íšŒì›ê°€ì… ì„±ê³µ!', 'success')
            return redirect(url_for('main.login'))
        except Exception as e:
            db.session.rollback()
            flash(f'íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}', 'danger')

    return render_template('register.html', form=form)

```

REST API ì½”ë“œ:

```python
@api_routes.route('/users', methods=['POST'])
def create_user():
    # JSON ë°ì´í„°ë¥¼ í†µí•œ ì‚¬ìš©ì ìƒì„±
    data = request.get_json()

    # ë°ì´í„° ê²€ì¦
    if not data or not data.get('username') or not data.get('email') or not data.get('password'):
        return jsonify({'error': 'í•„ìˆ˜ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.'}), 400

    # ì¤‘ë³µ ì‚¬ìš©ì í™•ì¸
    existing_user = User.query.filter(
        (User.username == data['username']) |
        (User.email == data['email'])
    ).first()

    if existing_user:
        return jsonify({'error': 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤.'}), 400

    # ìƒˆ ì‚¬ìš©ì ìƒì„±
    new_user = User(
        username=data['username'],
        email=data['email']
    )
    new_user.set_password(data['password'])

    try:
        db.session.add(new_user)
        db.session.commit()

        return jsonify({
            'id': new_user.id,
            'username': new_user.username,
            'email': new_user.email
        }), 201
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'ì‚¬ìš©ì ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'details': str(e)}), 500

```

**ì£¼ìš” ë³€ê²½ ì‚¬í•­ ë° ê·¸ ì˜ë¯¸**

a. ìš”ì²­ ë°ì´í„° ì²˜ë¦¬ ë°©ì‹

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜: HTML í¼ (`FlaskForm`)ì„ í†µí•œ ë°ì´í„° ìˆ˜ì‹ 
- REST API: JSON ë°ì´í„° ì§ì ‘ ìˆ˜ì‹  (`request.get_json()`)

```python
# ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
form = RegistrationForm()
username = form.username.data

# REST API
data = request.get_json()
username = data['username']

```

b. ì‘ë‹µ ë°©ì‹

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜: ì›¹ í˜ì´ì§€ ë Œë”ë§ ë˜ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸

```python
return render_template('register.html', form=form)
return redirect(url_for('main.login'))

```

- REST API: JSON ì‘ë‹µ ë° HTTP ìƒíƒœ ì½”ë“œ ë°˜í™˜

```python
return jsonify({
    'id': new_user.id,
    'username': new_user.username
}), 201  # Created ìƒíƒœ ì½”ë“œ

```

c. ë°ì´í„° ê²€ì¦

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜: WTForms ê²€ì¦ê¸° ì‚¬ìš©

```python
class RegistrationForm(FlaskForm):
    username = StringField('Username', validators=[
        DataRequired(),
        Length(min=2, max=20)
    ])

```

- REST API: ìˆ˜ë™ ë°ì´í„° ê²€ì¦

```python
if not data or not data.get('username'):
    return jsonify({'error': 'í•„ìˆ˜ ì •ë³´ ëˆ„ë½'}), 400

```

d. ì˜¤ë¥˜ ì²˜ë¦¬

- ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜: í”Œë˜ì‹œ ë©”ì‹œì§€ì™€ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸

```python
flash(f'íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}', 'danger')

```

- REST API: JSON ì˜¤ë¥˜ ì‘ë‹µê³¼ ìƒíƒœ ì½”ë“œ

```python
return jsonify({
    'error': 'ì‚¬ìš©ì ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ',
    'details': str(e)
}), 500

```

- REST APIë¡œ ì „í™˜ì˜ ì¥ì 
    - í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ë¶„ë¦¬
    - ë‹¤ì–‘í•œ í´ë¼ì´ì–¸íŠ¸(ì›¹, ëª¨ë°”ì¼ ì•± ë“±) ì§€ì›
    - í‘œì¤€í™”ëœ ë°ì´í„° êµí™˜ ë°©ì‹
    - í™•ì¥ì„±ê³¼ ìœ ì—°ì„± í–¥ìƒ
- ë„¤íŠ¸ì›Œí¬ ê´€ì ì—ì„œì˜ ë³€í™”
    - ìƒíƒœ ë¹„ì €ì¥(Stateless) í†µì‹ 
    - í‘œì¤€ HTTP ë©”ì„œë“œ í™œìš©
    - ëª…í™•í•œ ë°ì´í„° êµ¬ì¡° (JSON)
    - ì¼ê´€ëœ ì˜¤ë¥˜ ì²˜ë¦¬
- ì‹¤ìŠµ ë° í•™ìŠµ í¬ì¸íŠ¸:
    - Postmanìœ¼ë¡œ API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
    - ë‹¤ì–‘í•œ HTTP ë©”ì„œë“œ ì‹¤í—˜
    - ë°ì´í„° ê²€ì¦ ë¡œì§ ê°œì„ 
    - ë³´ì•ˆ ë° ì¸ì¦ ë©”ì»¤ë‹ˆì¦˜ ì¶”ê°€

â†’ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¼ìš°íŠ¸ë¥¼ REST API ì—”ë“œí¬ì¸íŠ¸ë¡œ ë³€í™˜í•¨. í†µì‹  ë°©ì‹ê³¼ ë°ì´í„° ì²˜ë¦¬ ë¡œì§ì´ ê°œì„ ë¨
